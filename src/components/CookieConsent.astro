---
const COOKIE_NAME = 'arizakodlari_consent';
const COOKIE_MAX_AGE = 365 * 24 * 60 * 60; // 1 yıl
---

<div id="cookie-consent" class="cookie-consent" role="dialog" aria-label="Çerez bildirimi" hidden>
  <div class="cookie-consent__inner wrap">
    <p class="cookie-consent__text">
      Sitemizde deneyiminizi iyileştirmek ve reklamları kişiselleştirmek için çerezler kullanılıyor olabilir. Detaylar için <a href="/cerez-bildirimi">Çerez bildirimi</a> ve <a href="/gizlilik-politikasi">Gizlilik politikası</a> sayfalarını inceleyebilirsiniz.
    </p>
    <div class="cookie-consent__actions">
      <button type="button" class="cookie-consent__btn cookie-consent__btn--reject" data-action="reject">Reddet</button>
      <button type="button" class="cookie-consent__btn cookie-consent__btn--accept" data-action="accept">Kabul et</button>
    </div>
  </div>
</div>

<script define:vars={{ COOKIE_NAME, COOKIE_MAX_AGE }}>
  (function () {
    const bar = document.getElementById('cookie-consent');
    if (!bar) return;

    function getConsent() {
      const match = document.cookie.match(new RegExp('(^| )' + COOKIE_NAME + '=([^;]+)'));
      return match ? match[2] : null;
    }

    function setConsent(action) {
      document.cookie = COOKIE_NAME + '=' + action + ';path=/;max-age=' + COOKIE_MAX_AGE + ';SameSite=Lax';
    }

    const saved = getConsent();
    if (saved === 'accepted' || saved === 'rejected') return;

    bar.hidden = false;
    document.body.classList.add('cookie-consent-visible');

    function close(action) {
      setConsent(action);
      bar.hidden = true;
      document.body.classList.remove('cookie-consent-visible');
    }

    bar.querySelectorAll('[data-action]').forEach((btn) => {
      btn.addEventListener('click', () => close(btn.dataset.action));
    });
  })();
</script>
